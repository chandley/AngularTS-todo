var ToDos;!function(o){var t=["ui.router","todos.root","todos.main","todos.filters"];o.appModule=angular.module("todos",t),o.appModule.config(["$stateProvider","$urlRouterProvider",function(o,t){o.state({name:"root",url:"/",templateUrl:"root/root.html",controller:"RootController",controllerAs:"rootCtrl"}),t.otherwise("/")}])}(ToDos||(ToDos={}));var ToDos;!function(o){o.directivesModule=angular.module("todos.directives",[])}(ToDos||(ToDos={}));var ToDos;!function(o){function t(){return{restrict:"A",require:"ngModel",link:e}}function e(o,t,e,r){r.$parsers.push(function(o){return moment(o)})}o.directivesModule.directive("momentInput",t)}(ToDos||(ToDos={}));var ToDos;!function(o){o.filterModule=angular.module("todos.filters",[])}(ToDos||(ToDos={}));var ToDos;!function(o){function t(o,t){if("string"!=typeof o)return o;var e=moment(o);return e.isValid()?e.format(t||"DD MM YYYY"):o}o.filterModule.filter("moment",function(){return t})}(ToDos||(ToDos={}));var ToDos;!function(o){o.rootModule=angular.module("todos.root",[])}(ToDos||(ToDos={}));var ToDos;!function(o){var t=function(){function o(o){this.$state=o,this.messages=["Welcome","New version is out"],this.showMessages=!0}return o.$inject=["$state"],o.prototype.toggleMessages=function(){this.showMessages=!this.showMessages},o.prototype.stateIs=function(o){return this.$state.is(o)},o}();o.rootModule.controller("RootController",t)}(ToDos||(ToDos={}));var ToDos;!function(o){var t=["ngMessages","ui.router","ui.bootstrap","todos.filters","todos.directives"];o.todosModule=angular.module("todos.main",t),o.todosModule.config(["$stateProvider",function(o){o.state({name:"root.todos",url:"todos",templateUrl:"/todos/list.html",controller:"ListController",controllerAs:"listCtrl"}).state({name:"root.todos.item",url:"/:id",templateUrl:"/todos/item.html",controller:"ItemController",controllerAs:"itemCtrl"})}])}(ToDos||(ToDos={}));var ToDos;!function(o){var t=function(){function o(o,t){this.todoService=o,this.$modalInstance=t}return o.$inject=["todoService","$modalInstance"],o.prototype.save=function(){var o=this,t={id:Date.now().toString(),text:this.text,created:moment().toISOString()};this.todoService.add(t).then(function(){o.$modalInstance.close()})},o}();o.todosModule.controller("AddNewController",t)}(ToDos||(ToDos={}));var ToDos;!function(o){var t=function(){function o(o,t,e){this.todoService=o,this.$window=t,this.$modal=e,this.load()}return o.$inject=["todoService","$window","$modal"],o.prototype.load=function(){var o=this;this.todoService.list().then(function(t){o.todos=t})["catch"](function(t){o.$window.console.log(t)})},o.prototype.addNew=function(){var o=this;this.$modal.open({controller:"AddNewController",controllerAs:"addNewCtrl",templateUrl:"/todos/addnew.html",backdrop:"static"}).result.then(function(){o.load()})},o}();o.todosModule.controller("ListController",t)}(ToDos||(ToDos={}));var ToDos;!function(o){var t=function(){function o(o){this.$http=o}return o.$inject=["$http"],o.prototype.list=function(){return this.$http.get("/api/todos",{cache:!1}).then(function(o){return o.data})},o.prototype.add=function(o){return this.$http.post("/api/todos",o).then(function(o){return o.data})},o.prototype.get=function(o){return this.$http.get("/api/todos/"+o).then(function(o){return o.data})},o}();o.ToDoService=t,o.todosModule.service("todoService",t)}(ToDos||(ToDos={}));var ToDos;!function(o){var t=function(){function o(o,t){var e=this;t.get(o.id).then(function(o){e.todo=o})}return o.$inject=["$stateParams","todoService"],o.prototype.save=function(){this.todo.due=moment(this.todo.due).toISOString()},o}();o.todosModule.controller("ItemController",t)}(ToDos||(ToDos={}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC50cyIsImRpcmVjdGl2ZXMvbW9kdWxlLnRzIiwiZGlyZWN0aXZlcy9tb21lbnRpbnB1dC50cyIsImFwcC5qcyIsImZpbHRlcnMvbW9kdWxlLnRzIiwiZmlsdGVycy9tb21lbnRGaWx0ZXIudHMiLCJyb290L21vZHVsZS50cyIsInJvb3QvUm9vdENvbnRyb2xsZXIudHMiLCJ0b2Rvcy9tb2R1bGUudHMiLCJ0b2Rvcy9BZGROZXdDb250cm9sbGVyLnRzIiwidG9kb3MvTGlzdENvbnRyb2xsZXIudHMiLCJ0b2Rvcy9Ub0RvU2VydmljZS50cyIsInRvZG9zL2l0ZW1Db250cm9sbGVyLnRzIl0sIm5hbWVzIjpbIlRvRG9zIiwiVG9Eb3MubW9tZW50SW5wdXQiLCJsaW5rTW9tZW50SW5wdXQiLCJUb0Rvcy5saW5rTW9tZW50SW5wdXQiLCJUb0Rvcy5tb21lbnRGaWx0ZXIiLCJUb0Rvcy5Sb290Q29udHJvbGxlciIsIlRvRG9zLlJvb3RDb250cm9sbGVyLmNvbnN0cnVjdG9yIiwiUm9vdENvbnRyb2xsZXIiLCIkaW5qZWN0IiwiVG9Eb3MuUm9vdENvbnRyb2xsZXIudG9nZ2xlTWVzc2FnZXMiLCJUb0Rvcy5Sb290Q29udHJvbGxlci5zdGF0ZUlzIiwiVG9Eb3MuQWRkTmV3Q29udHJvbGxlciIsIlRvRG9zLkFkZE5ld0NvbnRyb2xsZXIuY29uc3RydWN0b3IiLCJBZGROZXdDb250cm9sbGVyIiwiVG9Eb3MuQWRkTmV3Q29udHJvbGxlci5zYXZlIiwiVG9Eb3MuTGlzdENvbnRyb2xsZXIiLCJUb0Rvcy5MaXN0Q29udHJvbGxlci5jb25zdHJ1Y3RvciIsIkxpc3RDb250cm9sbGVyIiwiVG9Eb3MuTGlzdENvbnRyb2xsZXIubG9hZCIsIlRvRG9zLkxpc3RDb250cm9sbGVyLmFkZE5ldyIsIlRvRG9zLlRvRG9TZXJ2aWNlIiwiVG9Eb3MuVG9Eb1NlcnZpY2UuY29uc3RydWN0b3IiLCJUb0RvU2VydmljZSIsIlRvRG9zLlRvRG9TZXJ2aWNlLmxpc3QiLCJUb0Rvcy5Ub0RvU2VydmljZS5hZGQiLCJUb0Rvcy5Ub0RvU2VydmljZS5nZXQiLCJUb0Rvcy5JdGVtQ29udHJvbGxlciIsIlRvRG9zLkl0ZW1Db250cm9sbGVyLmNvbnN0cnVjdG9yIiwiSXRlbUNvbnRyb2xsZXIiLCJUb0Rvcy5JdGVtQ29udHJvbGxlci5zYXZlIl0sIm1hcHBpbmdzIjoiQUFJQSxHQUFVQSxRQUFWLFNBQVVBLEdBSU5BLEdBQUlBLElBQ0FBLFlBQ0FBLGFBQ0FBLGFBQ0FBLGdCQUVPQSxHQUFBQSxVQUFZQSxRQUFRQSxPQUFPQSxRQUFTQSxHQUUvQ0EsRUFBQUEsVUFBVUEsUUFBQUEsaUJBQUFBLHFCQUNOQSxTQUFDQSxFQUNEQSxHQUVBQSxFQUNLQSxPQUNHQSxLQUFNQSxPQUNOQSxJQUFLQSxJQUNMQSxZQUFhQSxpQkFDYkEsV0FBWUEsaUJBQ1pBLGFBQWNBLGFBR2xCQSxFQUFtQkEsVUFBVUEsU0F6Qi9CQSxRQUFBQSxVQ0pWLElBQVVBLFFBQVYsU0FBVUEsR0FFS0EsRUFBQUEsaUJBQ1BBLFFBQVFBLE9BQU9BLHdCQUhiQSxRQUFBQSxVQ0VWLElBQVVBLFFBQVYsU0FBVUEsR0FFTkEsUUFBQUEsS0FFUUMsT0FDSUEsU0FBVUEsSUFDVkEsUUFBU0EsVUFDVEEsS0FBTUEsR0NnQ2xCLFFBQVNDLEdEMUJvQkYsRUFBT0EsRUFBY0EsRUFBT0EsR0FFN0NHLEVBQUtBLFNBQVNBLEtBQUtBLFNBQUNBLEdBQVFBLE1BQUFBLFFBQU9BLEtBTy9DSCxFQUFBQSxpQkFBaUJBLFVBQVVBLGNBQWVBLElBdEJwQ0EsUUFBQUEsVUVGVixJQUFVQSxRQUFWLFNBQVVBLEdBRUdBLEVBQUFBLGFBQWVBLFFBQVFBLE9BQU9BLHFCQUZqQ0EsUUFBQUEsVUNFVixJQUFVQSxRQUFWLFNBQVVBLEdBRU5BLFFBQUFBLEdBQXNCQSxFQUFVQSxHQUM1QkksR0FBbUJBLGdCQUFSQSxHQUFrQkEsTUFBT0EsRUFFcENBLElBQUlBLEdBQUlBLE9BQU9BLEVBRWZBLE9BQUlBLEdBQUVBLFVBRUNBLEVBQUVBLE9BQU9BLEdBQVVB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QSxNQUFPQSxHQUFTQSxRQUdyQkgsRUFBQUEsVUFBQUEsSUFBUEEsU0FBV0EsR0FDUEksTUFBT0EsTUFBS0EsTUFBTUEsS0FBS0EsYUFBY0EsR0FDaENBLEtBQUtBLFNBQUNBLEdBQWFBLE1BQUFBLEdBQVNBLFFBRTlCSixFQUFBQSxVQUFBQSxJQUFQQSxTQUFXQSxHQUNQSyxNQUFPQSxNQUFLQSxNQUFNQSxJQUFVQSxjQUFnQkEsR0FDdkNBLEtBQUtBLFNBQUNBLEdBQWFBLE1BQUFBLEdBQVNBLFFBRXpDTCxJQWpCYXBCLEdBQUFBLFlBQVdBLEVBa0J4QkEsRUFBQUEsWUFBWUEsUUFBUUEsY0FBZUEsSUFuQjdCQSxRQUFBQSxVQ0FWLElBQVVBLFFBQVYsU0FBVUEsR0FJTkEsR0FBQUEsR0FBQUEsV0FFSTBCLFFBQUFBLEdBQVlBLEVBQ0FBLEdBSGhCQyxHQUFBQSxHQUFBQSxJQUlRQSxHQUFZQSxJQUFJQSxFQUFhQSxJQUN4QkEsS0FBS0EsU0FBQ0EsR0FDSEEsRUFBS0EsS0FBT0EsSUFTNUJELE1Ub05JRSxHQUFlcEIsU0FBVyxlQUFnQixlU3pObkNrQixFQUFBQSxVQUFBQSxLQUFQQSxXQUVJRyxLQUFLQSxLQUFLQSxJQUFNQSxPQUFPQSxLQUFLQSxLQUFLQSxLQUFLQSxlQUc5Q0gsSUFDQTFCLEdBQUFBLFlBQVlBLFdBQVdBLGlCQUFrQkEsSUFwQm5DQSxRQUFBQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyZWF0ZWQgYnkgY2hyaXNoYSBvbiAwMy8wOS8xNS5cbiAqL1xuXG5uYW1lc3BhY2UgVG9Eb3Mge1xuXG4gICAgZXhwb3J0IHR5cGUgTW9kYWxTZXJ2aWNlID0gYW5ndWxhci51aS5ib290c3RyYXAuSU1vZGFsU2VydmljZTtcblxuICAgIHZhciBkZXBzID0gW1xuICAgICAgICBcInVpLnJvdXRlclwiLFxuICAgICAgICBcInRvZG9zLnJvb3RcIixcbiAgICAgICAgXCJ0b2Rvcy5tYWluXCIsXG4gICAgICAgIFwidG9kb3MuZmlsdGVyc1wiXG4gICAgXVxuICAgIGV4cG9ydCB2YXIgYXBwTW9kdWxlID0gYW5ndWxhci5tb2R1bGUoXCJ0b2Rvc1wiLCBkZXBzKTtcblxuICAgIGFwcE1vZHVsZS5jb25maWcoXG4gICAgICAgICgkc3RhdGVQcm92aWRlcjogYW5ndWxhci51aS5JU3RhdGVQcm92aWRlcixcbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyOiBhbmd1bGFyLnVpLklVcmxSb3V0ZXJQcm92aWRlcikgPT4ge1xuXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoe1xuICAgICAgICAgICAgICAgIG5hbWU6IFwicm9vdFwiLFxuICAgICAgICAgICAgICAgIHVybDogXCIvXCIsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwicm9vdC9yb290Lmh0bWxcIixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBcIlJvb3RDb250cm9sbGVyXCIsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiBcInJvb3RDdHJsXCJcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoXCIvXCIpO1xuXG4gICAgfSlcblxufVxuIiwibmFtZXNwYWNlIFRvRG9zIHtcblxuICAgIGV4cG9ydCB2YXIgZGlyZWN0aXZlc01vZHVsZSA9XG4gICAgICAgIGFuZ3VsYXIubW9kdWxlKFwidG9kb3MuZGlyZWN0aXZlc1wiLCBbXSlcbjt9XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwibW9kdWxlLnRzXCIgLz5cblxubmFtZXNwYWNlIFRvRG9zIHtcblxuICAgIGZ1bmN0aW9uIG1vbWVudElucHV0KCk6IGFuZ3VsYXIuSURpcmVjdGl2ZSB7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcmVzdHJpY3Q6IFwiQVwiLFxuICAgICAgICAgICAgICAgIHJlcXVpcmU6IFwibmdNb2RlbFwiLFxuICAgICAgICAgICAgICAgIGxpbms6IGxpbmtNb21lbnRJbnB1dFxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9XG5cbiAgICAgICAgLy8gU0VBQ1xuICAgICAgICBmdW5jdGlvbiBsaW5rTW9tZW50SW5wdXQoc2NvcGUsIGVsZW06IEpRdWVyeSwgYXR0cnMsIGN0cmw6IGFuZ3VsYXIuSU5nTW9kZWxDb250cm9sbGVyKSB7XG5cbiAgICAgICAgICAgICAgICBjdHJsLiRwYXJzZXJzLnB1c2goKHZhbCkgPT4gbW9tZW50KHZhbCkpO1xuXG4gICAgICAgIH1cblxuXG5cblxuICAgIGRpcmVjdGl2ZXNNb2R1bGUuZGlyZWN0aXZlKFwibW9tZW50SW5wdXRcIiwgbW9tZW50SW5wdXQpO1xuXG59XG5cblxuXG5cbiIsIi8qKlxuICogQ3JlYXRlZCBieSBjaHJpc2hhIG9uIDAzLzA5LzE1LlxuICovXG52YXIgVG9Eb3M7XG4oZnVuY3Rpb24gKFRvRG9zKSB7XG4gICAgdmFyIGRlcHMgPSBbXG4gICAgICAgIFwidWkucm91dGVyXCIsXG4gICAgICAgIFwidG9kb3Mucm9vdFwiLFxuICAgICAgICBcInRvZG9zLm1haW5cIixcbiAgICAgICAgXCJ0b2Rvcy5maWx0ZXJzXCJcbiAgICBdO1xuICAgIFRvRG9zLmFwcE1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKFwidG9kb3NcIiwgZGVwcyk7XG4gICAgVG9Eb3MuYXBwTW9kdWxlLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKHtcbiAgICAgICAgICAgIG5hbWU6IFwicm9vdFwiLFxuICAgICAgICAgICAgdXJsOiBcIi9cIixcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBcInJvb3Qvcm9vdC5odG1sXCIsXG4gICAgICAgICAgICBjb250cm9sbGVyOiBcIlJvb3RDb250cm9sbGVyXCIsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6IFwicm9vdEN0cmxcIlxuICAgICAgICB9KTtcbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZShcIi9cIik7XG4gICAgfSk7XG59KShUb0RvcyB8fCAoVG9Eb3MgPSB7fSkpO1xuXG52YXIgVG9Eb3M7XG4oZnVuY3Rpb24gKFRvRG9zKSB7XG4gICAgVG9Eb3MuZGlyZWN0aXZlc01vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKFwidG9kb3MuZGlyZWN0aXZlc1wiLCBbXSk7XG59KShUb0RvcyB8fCAoVG9Eb3MgPSB7fSkpO1xuXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwibW9kdWxlLnRzXCIgLz5cbnZhciBUb0RvcztcbihmdW5jdGlvbiAoVG9Eb3MpIHtcbiAgICBmdW5jdGlvbiBtb21lbnRJbnB1dCgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiBcIkFcIixcbiAgICAgICAgICAgIHJlcXVpcmU6IFwibmdNb2RlbFwiLFxuICAgICAgICAgICAgbGluazogbGlua01vbWVudElucHV0XG4gICAgICAgIH07XG4gICAgfVxuICAgIC8vIFNFQUNcbiAgICBmdW5jdGlvbiBsaW5rTW9tZW50SW5wdXQoc2NvcGUsIGVsZW0sIGF0dHJzLCBjdHJsKSB7XG4gICAgICAgIGN0cmwuJHBhcnNlcnMucHVzaChmdW5jdGlvbiAodmFsKSB7IHJldHVybiBtb21lbnQodmFsKTsgfSk7XG4gICAgfVxuICAgIFRvRG9zLmRpcmVjdGl2ZXNNb2R1bGUuZGlyZWN0aXZlKFwibW9tZW50SW5wdXRcIiwgbW9tZW50SW5wdXQpO1xufSkoVG9Eb3MgfHwgKFRvRG9zID0ge30pKTtcblxudmFyIFRvRG9zO1xuKGZ1bmN0aW9uIChUb0Rvcykge1xuICAgIFRvRG9zLmZpbHRlck1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKFwidG9kb3MuZmlsdGVyc1wiLCBbXSk7XG59KShUb0RvcyB8fCAoVG9Eb3MgPSB7fSkpO1xuXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwibW9kdWxlLnRzXCIgLz5cbnZhciBUb0RvcztcbihmdW5jdGlvbiAoVG9Eb3MpIHtcbiAgICBmdW5jdGlvbiBtb21lbnRGaWx0ZXIodmFsLCBmb3JtYXQpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWwgIT09IFwic3RyaW5nXCIpXG4gICAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICB2YXIgbSA9IG1vbWVudCh2YWwpO1xuICAgICAgICBpZiAoIW0uaXNWYWxpZCgpKVxuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgcmV0dXJuIG0uZm9ybWF0KGZvcm1hdCB8fCBcIkREIE1NIFlZWVlcIik7XG4gICAgfVxuICAgIFRvRG9zLmZpbHRlck1vZHVsZS5maWx0ZXIoXCJtb21lbnRcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gbW9tZW50RmlsdGVyOyB9KTtcbn0pKFRvRG9zIHx8IChUb0RvcyA9IHt9KSk7XG5cbi8qKlxuICogQ3JlYXRlZCBieSBjaHJpc2hhIG9uIDAzLzA5LzE1LlxuICovXG52YXIgVG9Eb3M7XG4oZnVuY3Rpb24gKFRvRG9zKSB7XG4gICAgVG9Eb3Mucm9vdE1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKFwidG9kb3Mucm9vdFwiLCBbXSk7XG59KShUb0RvcyB8fCAoVG9Eb3MgPSB7fSkpO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgY2hyaXNoYSBvbiAwMy8wOS8xNS5cbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIm1vZHVsZS50c1wiIC8+XG52YXIgVG9Eb3M7XG4oZnVuY3Rpb24gKFRvRG9zKSB7XG4gICAgdmFyIFJvb3RDb250cm9sbGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gUm9vdENvbnRyb2xsZXIoJHN0YXRlKSB7XG4gICAgICAgICAgICB0aGlzLiRzdGF0ZSA9ICRzdGF0ZTtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZXMgPSBbXG4gICAgICAgICAgICAgICAgXCJXZWxjb21lXCIsXG4gICAgICAgICAgICAgICAgXCJOZXcgdmVyc2lvbiBpcyBvdXRcIlxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIHRoaXMuc2hvd01lc3NhZ2VzID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBSb290Q29udHJvbGxlci5wcm90b3R5cGUudG9nZ2xlTWVzc2FnZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dNZXNzYWdlcyA9ICF0aGlzLnNob3dNZXNzYWdlcztcbiAgICAgICAgfTtcbiAgICAgICAgUm9vdENvbnRyb2xsZXIucHJvdG90eXBlLnN0YXRlSXMgPSBmdW5jdGlvbiAoc3RhdGVOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kc3RhdGUuaXMoc3RhdGVOYW1lKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFJvb3RDb250cm9sbGVyO1xuICAgIH0pKCk7XG4gICAgVG9Eb3Mucm9vdE1vZHVsZS5jb250cm9sbGVyKFwiUm9vdENvbnRyb2xsZXJcIiwgUm9vdENvbnRyb2xsZXIpO1xufSkoVG9Eb3MgfHwgKFRvRG9zID0ge30pKTtcblxudmFyIFRvRG9zO1xuKGZ1bmN0aW9uIChUb0Rvcykge1xuICAgIHZhciBkZXBzID0gW1xuICAgICAgICBcIm5nTWVzc2FnZXNcIixcbiAgICAgICAgXCJ1aS5yb3V0ZXJcIixcbiAgICAgICAgXCJ1aS5ib290c3RyYXBcIixcbiAgICAgICAgXCJ0b2Rvcy5maWx0ZXJzXCIsXG4gICAgICAgIFwidG9kb3MuZGlyZWN0aXZlc1wiXG4gICAgXTtcbiAgICBUb0Rvcy50b2Rvc01vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKFwidG9kb3MubWFpblwiLCBkZXBzKTtcbiAgICBUb0Rvcy50b2Rvc01vZHVsZS5jb25maWcoZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoe1xuICAgICAgICAgICAgbmFtZTogXCJyb290LnRvZG9zXCIsXG4gICAgICAgICAgICB1cmw6IFwidG9kb3NcIixcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBcIi90b2Rvcy9saXN0Lmh0bWxcIixcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFwiTGlzdENvbnRyb2xsZXJcIixcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogXCJsaXN0Q3RybFwiXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoe1xuICAgICAgICAgICAgbmFtZTogXCJyb290LnRvZG9zLml0ZW1cIixcbiAgICAgICAgICAgIHVybDogXCIvOmlkXCIsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogXCIvdG9kb3MvaXRlbS5odG1sXCIsXG4gICAgICAgICAgICBjb250cm9sbGVyOiBcIkl0ZW1Db250cm9sbGVyXCIsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6IFwiaXRlbUN0cmxcIlxuICAgICAgICB9KTtcbiAgICB9KTtcbn0pKFRvRG9zIHx8IChUb0RvcyA9IHt9KSk7XG5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJtb2R1bGUudHNcIiAvPlxudmFyIFRvRG9zO1xuKGZ1bmN0aW9uIChUb0Rvcykge1xuICAgIHZhciBBZGROZXdDb250cm9sbGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gQWRkTmV3Q29udHJvbGxlcih0b2RvU2VydmljZSwgJG1vZGFsSW5zdGFuY2UpIHtcbiAgICAgICAgICAgIHRoaXMudG9kb1NlcnZpY2UgPSB0b2RvU2VydmljZTtcbiAgICAgICAgICAgIHRoaXMuJG1vZGFsSW5zdGFuY2UgPSAkbW9kYWxJbnN0YW5jZTtcbiAgICAgICAgfVxuICAgICAgICBBZGROZXdDb250cm9sbGVyLnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHZhciB0b2RvID0ge1xuICAgICAgICAgICAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgdGV4dDogdGhpcy50ZXh0LFxuICAgICAgICAgICAgICAgIGNyZWF0ZWQ6IG1vbWVudCgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnRvZG9TZXJ2aWNlLmFkZCh0b2RvKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy4kbW9kYWxJbnN0YW5jZS5jbG9zZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBBZGROZXdDb250cm9sbGVyO1xuICAgIH0pKCk7XG4gICAgVG9Eb3MudG9kb3NNb2R1bGUuY29udHJvbGxlcihcIkFkZE5ld0NvbnRyb2xsZXJcIiwgQWRkTmV3Q29udHJvbGxlcik7XG59KShUb0RvcyB8fCAoVG9Eb3MgPSB7fSkpO1xuXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwibW9kdWxlLnRzXCIgLz5cbnZhciBUb0RvcztcbihmdW5jdGlvbiAoVG9Eb3MpIHtcbiAgICB2YXIgTGlzdENvbnRyb2xsZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBMaXN0Q29udHJvbGxlcih0b2RvU2VydmljZSwgJHdpbmRvdywgJG1vZGFsKSB7XG4gICAgICAgICAgICB0aGlzLnRvZG9TZXJ2aWNlID0gdG9kb1NlcnZpY2U7XG4gICAgICAgICAgICB0aGlzLiR3aW5kb3cgPSAkd2luZG93O1xuICAgICAgICAgICAgdGhpcy4kbW9kYWwgPSAkbW9kYWw7XG4gICAgICAgICAgICB0aGlzLmxvYWQoKTtcbiAgICAgICAgfVxuICAgICAgICBMaXN0Q29udHJvbGxlci5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLnRvZG9TZXJ2aWNlLmxpc3QoKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh0b2Rvcykge1xuICAgICAgICAgICAgICAgIF90aGlzLnRvZG9zID0gdG9kb3M7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy4kd2luZG93LmNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBMaXN0Q29udHJvbGxlci5wcm90b3R5cGUuYWRkTmV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuJG1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFwiQWRkTmV3Q29udHJvbGxlclwiLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogXCJhZGROZXdDdHJsXCIsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwiL3RvZG9zL2FkZG5ldy5odG1sXCIsXG4gICAgICAgICAgICAgICAgYmFja2Ryb3A6IFwic3RhdGljXCIgLy8gcHJldmVudHMgY2xpY2thd2F5IGZyb20gY2xvc2luZ1xuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmxvYWQoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gTGlzdENvbnRyb2xsZXI7XG4gICAgfSkoKTtcbiAgICBUb0Rvcy50b2Rvc01vZHVsZS5jb250cm9sbGVyKFwiTGlzdENvbnRyb2xsZXJcIiwgTGlzdENvbnRyb2xsZXIpO1xufSkoVG9Eb3MgfHwgKFRvRG9zID0ge30pKTtcblxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIm1vZHVsZS50c1wiIC8+XG52YXIgVG9Eb3M7XG4oZnVuY3Rpb24gKFRvRG9zKSB7XG4gICAgdmFyIFRvRG9TZXJ2aWNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gVG9Eb1NlcnZpY2UoJGh0dHApIHtcbiAgICAgICAgICAgIHRoaXMuJGh0dHAgPSAkaHR0cDtcbiAgICAgICAgfVxuICAgICAgICBUb0RvU2VydmljZS5wcm90b3R5cGUubGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLmdldChcIi9hcGkvdG9kb3NcIiwgeyBjYWNoZTogZmFsc2UgfSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBUb0RvU2VydmljZS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKHRvZG8pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnBvc3QoXCIvYXBpL3RvZG9zXCIsIHRvZG8pXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7IHJldHVybiByZXNwb25zZS5kYXRhOyB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgVG9Eb1NlcnZpY2UucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAuZ2V0KFwiL2FwaS90b2Rvcy9cIiArIGlkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgeyByZXR1cm4gcmVzcG9uc2UuZGF0YTsgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBUb0RvU2VydmljZTtcbiAgICB9KSgpO1xuICAgIFRvRG9zLlRvRG9TZXJ2aWNlID0gVG9Eb1NlcnZpY2U7XG4gICAgVG9Eb3MudG9kb3NNb2R1bGUuc2VydmljZShcInRvZG9TZXJ2aWNlXCIsIFRvRG9TZXJ2aWNlKTtcbn0pKFRvRG9zIHx8IChUb0RvcyA9IHt9KSk7XG5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJtb2R1bGUudHNcIiAvPlxudmFyIFRvRG9zO1xuKGZ1bmN0aW9uIChUb0Rvcykge1xuICAgIHZhciBJdGVtQ29udHJvbGxlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIEl0ZW1Db250cm9sbGVyKCRzdGF0ZVBhcmFtcywgdG9kb1NlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0b2RvU2VydmljZS5nZXQoJHN0YXRlUGFyYW1zLmlkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh0b2RvKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMudG9kbyA9IHRvZG87XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBJdGVtQ29udHJvbGxlci5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMudG9kby5kdWUgPSBtb21lbnQodGhpcy50b2RvLmR1ZSkudG9JU09TdHJpbmcoKTtcbiAgICAgICAgICAgIGRlYnVnZ2VyO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gSXRlbUNvbnRyb2xsZXI7XG4gICAgfSkoKTtcbiAgICBUb0Rvcy50b2Rvc01vZHVsZS5jb250cm9sbGVyKFwiSXRlbUNvbnRyb2xsZXJcIiwgSXRlbUNvbnRyb2xsZXIpO1xufSkoVG9Eb3MgfHwgKFRvRG9zID0ge30pKTtcbiIsIm5hbWVzcGFjZSBUb0RvcyB7XG5cbiAgZXhwb3J0IHZhciBmaWx0ZXJNb2R1bGUgPSBhbmd1bGFyLm1vZHVsZShcInRvZG9zLmZpbHRlcnNcIiwgW10pXG5cbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJtb2R1bGUudHNcIiAvPlxuXG5uYW1lc3BhY2UgVG9Eb3Mge1xuXG4gICAgZnVuY3Rpb24gbW9tZW50RmlsdGVyKHZhbDogYW55LCBmb3JtYXQ/OiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWwgIT09IFwic3RyaW5nXCIpIHJldHVybiB2YWw7XG5cbiAgICAgICAgdmFyIG0gPSBtb21lbnQodmFsKTtcblxuICAgICAgICBpZighbS5pc1ZhbGlkKCkpIHJldHVybiB2YWw7XG5cbiAgICAgICAgcmV0dXJuIG0uZm9ybWF0KGZvcm1hdCB8fCBcIkREIE1NIFlZWVlcIik7XG5cbiAgICB9XG5cbiAgICBmaWx0ZXJNb2R1bGUuZmlsdGVyKFwibW9tZW50XCIsICgpID0+IG1vbWVudEZpbHRlcik7XG5cbn1cbiIsIi8qKlxuICogQ3JlYXRlZCBieSBjaHJpc2hhIG9uIDAzLzA5LzE1LlxuICovXG5cbm5hbWVzcGFjZSBUb0RvcyB7XG5cbiAgICBleHBvcnQgdmFyIHJvb3RNb2R1bGUgPSBhbmd1bGFyLm1vZHVsZShcInRvZG9zLnJvb3RcIiwgW10pO1xuXG59IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGNocmlzaGEgb24gMDMvMDkvMTUuXG4gKi9cblxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIm1vZHVsZS50c1wiIC8+XG5uYW1lc3BhY2UgVG9Eb3Mge1xuXG4gICAgY2xhc3MgUm9vdENvbnRyb2xsZXIge1xuICAgICAgICBwdWJsaWMgbWVzc2FnZXM6IHN0cmluZ1tdID0gW1xuICAgICAgICAgICAgXCJXZWxjb21lXCIsXG4gICAgICAgICAgICBcIk5ldyB2ZXJzaW9uIGlzIG91dFwiXG4gICAgICAgIF07XG5cbiAgICAgICAgcHVibGljIHNob3dNZXNzYWdlcyA9IHRydWU7XG5cbiAgICAgICAgY29uc3RydWN0b3IocHJpdmF0ZSAkc3RhdGU6IGFuZ3VsYXIudWkuSVN0YXRlU2VydmljZSkge1xuXG4gICAgICAgIH1cbiAgICAgICAgcHVibGljIHRvZ2dsZU1lc3NhZ2VzKCkge1xuICAgICAgICAgICAgdGhpcy5zaG93TWVzc2FnZXMgPSAhdGhpcy5zaG93TWVzc2FnZXM7XG4gICAgICAgIH1cblxuICAgICAgICBwdWJsaWMgc3RhdGVJcyhzdGF0ZU5hbWU6IHN0cmluZykge1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kc3RhdGUuaXMoc3RhdGVOYW1lKTtcblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcm9vdE1vZHVsZS5jb250cm9sbGVyKFwiUm9vdENvbnRyb2xsZXJcIiwgUm9vdENvbnRyb2xsZXIpXG59XG4iLCJcbm5hbWVzcGFjZSBUb0RvcyB7XG5cbiAgICB2YXIgZGVwcyA9IFtcbiAgICAgICAgXCJuZ01lc3NhZ2VzXCIsXG4gICAgICAgIFwidWkucm91dGVyXCIsXG4gICAgICAgIFwidWkuYm9vdHN0cmFwXCIsXG4gICAgICAgIFwidG9kb3MuZmlsdGVyc1wiLFxuICAgICAgICBcInRvZG9zLmRpcmVjdGl2ZXNcIlxuICAgIF1cblxuICAgIGV4cG9ydCB2YXIgdG9kb3NNb2R1bGUgPSBhbmd1bGFyLm1vZHVsZShcInRvZG9zLm1haW5cIiwgZGVwcyk7XG5cbiAgICB0b2Rvc01vZHVsZS5jb25maWcoKCRzdGF0ZVByb3ZpZGVyOiBhbmd1bGFyLnVpLklTdGF0ZVByb3ZpZGVyKSA9PiB7XG5cbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSh7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJyb290LnRvZG9zXCIsXG4gICAgICAgICAgICAgICAgdXJsOiBcInRvZG9zXCIsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwiL3RvZG9zL2xpc3QuaHRtbFwiLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFwiTGlzdENvbnRyb2xsZXJcIixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6IFwibGlzdEN0cmxcIlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSh7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJyb290LnRvZG9zLml0ZW1cIixcbiAgICAgICAgICAgICAgICB1cmw6IFwiLzppZFwiLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBcIi90b2Rvcy9pdGVtLmh0bWxcIixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBcIkl0ZW1Db250cm9sbGVyXCIsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiBcIml0ZW1DdHJsXCJcbiAgICAgICAgICAgIH0pO1xuICAgIH0pXG5cbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJtb2R1bGUudHNcIiAvPlxubmFtZXNwYWNlIFRvRG9zIHtcbiAgICBjbGFzcyBBZGROZXdDb250cm9sbGVyIHtcbiAgICAgICAgcHVibGljIHRleHQ6IHN0cmluZztcbiAgICAgICAgY29uc3RydWN0b3IocHJpdmF0ZSB0b2RvU2VydmljZTogVG9Eb1NlcnZpY2UsXG4gICAgICAgICAgICAgICAgICAgIHByaXZhdGUgJG1vZGFsSW5zdGFuY2U6IGFuZ3VsYXIudWkuYm9vdHN0cmFwLklNb2RhbFNlcnZpY2VJbnN0YW5jZSkge1xuICAgICAgICB9XG4gICAgICAgIHB1YmxpYyBzYXZlKCkge1xuICAgICAgICAgICAgdmFyIHRvZG8gPSB7XG4gICAgICAgICAgICAgICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRleHQsXG4gICAgICAgICAgICAgICAgY3JlYXRlZDogbW9tZW50KCkudG9JU09TdHJpbmcoKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMudG9kb1NlcnZpY2UuYWRkKHRvZG8pXG4gICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiRtb2RhbEluc3RhbmNlLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9kb3NNb2R1bGUuY29udHJvbGxlcihcIkFkZE5ld0NvbnRyb2xsZXJcIiwgQWRkTmV3Q29udHJvbGxlcik7XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwibW9kdWxlLnRzXCIgLz5cblxubmFtZXNwYWNlIFRvRG9zIHtcblxuICAgIGludGVyZmFjZSBUb0RvIHtcbiAgICAgICAgaWQ6IHN0cmluZztcbiAgICAgICAgdGV4dDogc3RyaW5nO1xuICAgICAgICB0YWdzOiBzdHJpbmdbXTsgLy8gYWN0dWFsbCBkYXRlc1xuICAgICAgICBkdWU6IHN0cmluZzsgLy8gYWN0dWFsbCBkYXRlXG4gICAgICAgIGRvbmU6IHN0cmluZzsgLy8gYWN0dWFsbCBkYXRlXG5cbiAgICB9XG5cbiAgICBjbGFzcyBMaXN0Q29udHJvbGxlciB7XG4gICAgICAgIHB1YmxpYyB0b2RvczpUb0RvW107XG5cbiAgICAgICAgY29uc3RydWN0b3IocHJpdmF0ZSB0b2RvU2VydmljZTpUb0RvU2VydmljZSxcbiAgICAgICAgICAgICAgICAgICAgcHJpdmF0ZSAkd2luZG93OmFuZ3VsYXIuSVdpbmRvd1NlcnZpY2UsXG4gICAgICAgICAgICAgICAgICAgIHByaXZhdGUgJG1vZGFsOk1vZGFsU2VydmljZSkge1xuICAgICAgICAgICAgdGhpcy5sb2FkKCk7XG4gICAgICAgIH1cblxuXG4gICAgICAgIHByaXZhdGVcbiAgICAgICAgICAgIGxvYWQoKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMudG9kb1NlcnZpY2UubGlzdCgpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKCh0b2RvcykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b2RvcyA9IHRvZG9zO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiR3aW5kb3cuY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgcHVibGljIGFkZE5ldygpIHtcbiAgICAgICAgICAgIHRoaXMuJG1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFwiQWRkTmV3Q29udHJvbGxlclwiLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogXCJhZGROZXdDdHJsXCIsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwiL3RvZG9zL2FkZG5ldy5odG1sXCIsXG4gICAgICAgICAgICAgICAgYmFja2Ryb3A6IFwic3RhdGljXCIgLy8gcHJldmVudHMgY2xpY2thd2F5IGZyb20gY2xvc2luZ1xuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWQoKTtcblxuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0b2Rvc01vZHVsZS5jb250cm9sbGVyKFwiTGlzdENvbnRyb2xsZXJcIiwgTGlzdENvbnRyb2xsZXIpO1xuXG5cblxufSIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJtb2R1bGUudHNcIiAvPlxubmFtZXNwYWNlIFRvRG9zIHtcbiAgICBleHBvcnQgY2xhc3MgVG9Eb1NlcnZpY2Uge1xuICAgICAgICBjb25zdHJ1Y3Rvcihwcml2YXRlICRodHRwOiBhbmd1bGFyLklIdHRwU2VydmljZSkge1xuICAgICAgICB9XG4gICAgICAgIHB1YmxpYyBsaXN0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAuZ2V0PFRvRG9bXT4oXCIvYXBpL3RvZG9zXCIsIHtjYWNoZTogZmFsc2V9KVxuICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBwdWJsaWMgYWRkKHRvZG86IFRvRG8pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnBvc3QoXCIvYXBpL3RvZG9zXCIsIHRvZG8pXG4gICAgICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiByZXNwb25zZS5kYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBwdWJsaWMgZ2V0KGlkOnN0cmluZykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAuZ2V0PFRvRG8+KFwiL2FwaS90b2Rvcy9cIiArIGlkKVxuICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gcmVzcG9uc2UuZGF0YSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9kb3NNb2R1bGUuc2VydmljZShcInRvZG9TZXJ2aWNlXCIsIFRvRG9TZXJ2aWNlKTtcbn1cblxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIm1vZHVsZS50c1wiIC8+XG5uYW1lc3BhY2UgVG9Eb3Mge1xuICAgIGludGVyZmFjZSBJdGVtU3RhdGVQYXJhbXMge1xuICAgICAgICBpZDogc3RyaW5nO1xuICAgIH1cbiAgICBjbGFzcyBJdGVtQ29udHJvbGxlciB7XG4gICAgICAgIHB1YmxpYyB0b2RvOiBUb0RvO1xuICAgICAgICBjb25zdHJ1Y3Rvcigkc3RhdGVQYXJhbXM6IEl0ZW1TdGF0ZVBhcmFtcyxcbiAgICAgICAgICAgICAgICAgICAgdG9kb1NlcnZpY2U6IFRvRG9TZXJ2aWNlKSB7XG4gICAgICAgICAgICB0b2RvU2VydmljZS5nZXQoJHN0YXRlUGFyYW1zLmlkKVxuICAgICAgICAgICAgICAgIC50aGVuKCh0b2RvKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9kbyA9IHRvZG87XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBwdWJsaWMgc2F2ZSgpIHtcblxuICAgICAgICAgICAgdGhpcy50b2RvLmR1ZSA9IG1vbWVudCh0aGlzLnRvZG8uZHVlKS50b0lTT1N0cmluZygpO1xuICAgICAgICAgICAgZGVidWdnZXI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9kb3NNb2R1bGUuY29udHJvbGxlcihcIkl0ZW1Db250cm9sbGVyXCIsIEl0ZW1Db250cm9sbGVyKTtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==