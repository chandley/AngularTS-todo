var ToDos;!function(o){var t=["ui.router","todos.root","todos.main","todos.filters"];o.appModule=angular.module("todos",t),o.appModule.config(["$stateProvider","$urlRouterProvider",function(o,t){o.state({name:"root",url:"/",templateUrl:"root/root.html",controller:"RootController",controllerAs:"rootCtrl"}),t.otherwise("/")}])}(ToDos||(ToDos={}));var ToDos;!function(o){o.filterModule=angular.module("todos.filters",[])}(ToDos||(ToDos={}));var ToDos;!function(o){function t(o,t){if("string"!=typeof o)return o;var e=moment(o);return e.isValid()?e.format(t||"DD MM YYYY"):o}o.filterModule.filter("moment",function(){return t})}(ToDos||(ToDos={}));var ToDos;!function(o){o.rootModule=angular.module("todos.root",[])}(ToDos||(ToDos={}));var ToDos;!function(o){var t=function(){function o(o){this.$state=o,this.messages=["Welcome","New version is out"],this.showMessages=!0}return o.$inject=["$state"],o.prototype.toggleMessages=function(){this.showMessages=!this.showMessages},o.prototype.stateIs=function(o){return this.$state.is(o)},o}();o.rootModule.controller("RootController",t)}(ToDos||(ToDos={}));var ToDos;!function(o){var t=["ngMessages","ui.router","ui.bootstrap","todos.filters"];o.todosModule=angular.module("todos.main",t),o.todosModule.config(["$stateProvider",function(o){o.state({name:"root.todos",url:"todos",templateUrl:"/todos/list.html",controller:"ListController",controllerAs:"listCtrl"}).state({name:"root.todos.item",url:"/:id",templateUrl:"/todos/item.html",controller:"ItemController",controllerAs:"itemCtrl"})}])}(ToDos||(ToDos={}));var ToDos;!function(o){var t=function(){function o(o,t){this.todoService=o,this.$modalInstance=t}return o.$inject=["todoService","$modalInstance"],o.prototype.save=function(){var o=this,t={id:Date.now().toString(),text:this.text,created:moment().toISOString()};this.todoService.add(t).then(function(){o.$modalInstance.close()})},o}();o.todosModule.controller("AddNewController",t)}(ToDos||(ToDos={}));var ToDos;!function(o){var t=function(){function o(o,t,e){this.todoService=o,this.$window=t,this.$modal=e,this.load()}return o.$inject=["todoService","$window","$modal"],o.prototype.load=function(){var o=this;this.todoService.list().then(function(t){o.todos=t})["catch"](function(t){o.$window.console.log(t)})},o.prototype.addNew=function(){var o=this;this.$modal.open({controller:"AddNewController",controllerAs:"addNewCtrl",templateUrl:"/todos/addnew.html",backdrop:"static"}).result.then(function(){o.load()})},o}();o.todosModule.controller("ListController",t)}(ToDos||(ToDos={}));var ToDos;!function(o){var t=function(){function o(o){this.$http=o}return o.$inject=["$http"],o.prototype.list=function(){return this.$http.get("/api/todos",{cache:!1}).then(function(o){return o.data})},o.prototype.add=function(o){return this.$http.post("/api/todos",o).then(function(o){return o.data})},o.prototype.get=function(o){return this.$http.get("/api/todos/"+o).then(function(o){return o.data})},o}();o.ToDoService=t,o.todosModule.service("todoService",t)}(ToDos||(ToDos={}));var ToDos;!function(o){var t=function(){function o(o,t){var e=this;t.get(o.id).then(function(o){e.todo=o})}return o.$inject=["$stateParams","todoService"],o}();o.todosModule.controller("ItemController",t)}(ToDos||(ToDos={}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC50cyIsImZpbHRlcnMvbW9kdWxlLnRzIiwiZmlsdGVycy9tb21lbnRGaWx0ZXIudHMiLCJyb290L21vZHVsZS50cyIsInJvb3QvUm9vdENvbnRyb2xsZXIudHMiLCJhcHAuanMiLCJ0b2Rvcy9tb2R1bGUudHMiLCJ0b2Rvcy9BZGROZXdDb250cm9sbGVyLnRzIiwidG9kb3MvTGlzdENvbnRyb2xsZXIudHMiLCJ0b2Rvcy9Ub0RvU2VydmljZS50cyIsInRvZG9zL2l0ZW1Db250cm9sbGVyLnRzIl0sIm5hbWVzIjpbIlRvRG9zIiwiVG9Eb3MubW9tZW50RmlsdGVyIiwiVG9Eb3MuUm9vdENvbnRyb2xsZXIiLCJUb0Rvcy5Sb290Q29udHJvbGxlci5jb25zdHJ1Y3RvciIsIlJvb3RDb250cm9sbGVyIiwiJGluamVjdCIsIlRvRG9zLlJvb3RDb250cm9sbGVyLnRvZ2dsZU1lc3NhZ2VzIiwiVG9Eb3MuUm9vdENvbnRyb2xsZXIuc3RhdGVJcyIsIlRvRG9zLkFkZE5ld0NvbnRyb2xsZXIiLCJUb0Rvcy5BZGROZXdDb250cm9sbGVyLmNvbnN0cnVjdG9yIiwiQWRkTmV3Q29udHJvbGxlciIsIlRvRG9zLkFkZE5ld0NvbnRyb2xsZXIuc2F2ZSIsIlRvRG9zLkxpc3RDb250cm9sbGVyIiwiVG9Eb3MuTGlzdENvbnRyb2xsZXIuY29uc3RydWN0b3IiLCJMaXN0Q29udHJvbGxlciIsIlRvRG9zLkxpc3RDb250cm9sbGVyLmxvYWQiLCJUb0Rvcy5MaXN0Q29udHJvbGxlci5hZGROZXciLCJUb0Rvcy5Ub0RvU2VydmljZSIsIlRvRG9zLlRvRG9TZXJ2aWNlLmNvbnN0cnVjdG9yIiwiVG9Eb1NlcnZpY2UiLCJUb0Rvcy5Ub0RvU2VydmljZS5saXN0IiwiVG9Eb3MuVG9Eb1NlcnZpY2UuYWRkIiwiVG9Eb3MuVG9Eb1NlcnZpY2UuZ2V0IiwiVG9Eb3MuSXRlbUNvbnRyb2xsZXIiLCJUb0Rvcy5JdGVtQ29udHJvbGxlci5jb25zdHJ1Y3RvciIsIkl0ZW1Db250cm9sbGVy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Q0hBLEVBQUtBLEtBQU9BLElBRzVCRCxNTG1NSUUsR0FBZXBCLFNBQVcsZUFBZ0IsZUtuTTlDa0IsSUFDQXZCLEdBQUFBLFlBQVlBLFdBQVdBLGlCQUFrQkEsSUFkbkNBLFFBQUFBIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ3JlYXRlZCBieSBjaHJpc2hhIG9uIDAzLzA5LzE1LlxuICovXG5cbm5hbWVzcGFjZSBUb0RvcyB7XG5cbiAgICBleHBvcnQgdHlwZSBNb2RhbFNlcnZpY2UgPSBhbmd1bGFyLnVpLmJvb3RzdHJhcC5JTW9kYWxTZXJ2aWNlO1xuXG4gICAgdmFyIGRlcHMgPSBbXG4gICAgICAgIFwidWkucm91dGVyXCIsXG4gICAgICAgIFwidG9kb3Mucm9vdFwiLFxuICAgICAgICBcInRvZG9zLm1haW5cIixcbiAgICAgICAgXCJ0b2Rvcy5maWx0ZXJzXCJcbiAgICBdXG4gICAgZXhwb3J0IHZhciBhcHBNb2R1bGUgPSBhbmd1bGFyLm1vZHVsZShcInRvZG9zXCIsIGRlcHMpO1xuXG4gICAgYXBwTW9kdWxlLmNvbmZpZyhcbiAgICAgICAgKCRzdGF0ZVByb3ZpZGVyOiBhbmd1bGFyLnVpLklTdGF0ZVByb3ZpZGVyLFxuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXI6IGFuZ3VsYXIudWkuSVVybFJvdXRlclByb3ZpZGVyKSA9PiB7XG5cbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSh7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJyb290XCIsXG4gICAgICAgICAgICAgICAgdXJsOiBcIi9cIixcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogXCJyb290L3Jvb3QuaHRtbFwiLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFwiUm9vdENvbnRyb2xsZXJcIixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6IFwicm9vdEN0cmxcIlxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZShcIi9cIik7XG5cbiAgICB9KVxuXG59XG4iLCJuYW1lc3BhY2UgVG9Eb3Mge1xuXG4gIGV4cG9ydCB2YXIgZmlsdGVyTW9kdWxlID0gYW5ndWxhci5tb2R1bGUoXCJ0b2Rvcy5maWx0ZXJzXCIsIFtdKVxuXG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwibW9kdWxlLnRzXCIgLz5cblxubmFtZXNwYWNlIFRvRG9zIHtcblxuICAgIGZ1bmN0aW9uIG1vbWVudEZpbHRlcih2YWw6IGFueSwgZm9ybWF0Pzogc3RyaW5nKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsICE9PSBcInN0cmluZ1wiKSByZXR1cm4gdmFsO1xuXG4gICAgICAgIHZhciBtID0gbW9tZW50KHZhbCk7XG5cbiAgICAgICAgaWYoIW0uaXNWYWxpZCgpKSByZXR1cm4gdmFsO1xuXG4gICAgICAgIHJldHVybiBtLmZvcm1hdChmb3JtYXQgfHwgXCJERCBNTSBZWVlZXCIpO1xuXG4gICAgfVxuXG4gICAgZmlsdGVyTW9kdWxlLmZpbHRlcihcIm1vbWVudFwiLCAoKSA9PiBtb21lbnRGaWx0ZXIpO1xuXG59XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgY2hyaXNoYSBvbiAwMy8wOS8xNS5cbiAqL1xuXG5uYW1lc3BhY2UgVG9Eb3Mge1xuXG4gICAgZXhwb3J0IHZhciByb290TW9kdWxlID0gYW5ndWxhci5tb2R1bGUoXCJ0b2Rvcy5yb290XCIsIFtdKTtcblxufSIsIi8qKlxuICogQ3JlYXRlZCBieSBjaHJpc2hhIG9uIDAzLzA5LzE1LlxuICovXG5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJtb2R1bGUudHNcIiAvPlxubmFtZXNwYWNlIFRvRG9zIHtcblxuICAgIGNsYXNzIFJvb3RDb250cm9sbGVyIHtcbiAgICAgICAgcHVibGljIG1lc3NhZ2VzOiBzdHJpbmdbXSA9IFtcbiAgICAgICAgICAgIFwiV2VsY29tZVwiLFxuICAgICAgICAgICAgXCJOZXcgdmVyc2lvbiBpcyBvdXRcIlxuICAgICAgICBdO1xuXG4gICAgICAgIHB1YmxpYyBzaG93TWVzc2FnZXMgPSB0cnVlO1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgJHN0YXRlOiBhbmd1bGFyLnVpLklTdGF0ZVNlcnZpY2UpIHtcblxuICAgICAgICB9XG4gICAgICAgIHB1YmxpYyB0b2dnbGVNZXNzYWdlcygpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd01lc3NhZ2VzID0gIXRoaXMuc2hvd01lc3NhZ2VzO1xuICAgICAgICB9XG5cbiAgICAgICAgcHVibGljIHN0YXRlSXMoc3RhdGVOYW1lOiBzdHJpbmcpIHtcblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHN0YXRlLmlzKHN0YXRlTmFtZSk7XG5cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJvb3RNb2R1bGUuY29udHJvbGxlcihcIlJvb3RDb250cm9sbGVyXCIsIFJvb3RDb250cm9sbGVyKVxufVxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGNocmlzaGEgb24gMDMvMDkvMTUuXG4gKi9cbnZhciBUb0RvcztcbihmdW5jdGlvbiAoVG9Eb3MpIHtcbiAgICB2YXIgZGVwcyA9IFtcbiAgICAgICAgXCJ1aS5yb3V0ZXJcIixcbiAgICAgICAgXCJ0b2Rvcy5yb290XCIsXG4gICAgICAgIFwidG9kb3MubWFpblwiLFxuICAgICAgICBcInRvZG9zLmZpbHRlcnNcIlxuICAgIF07XG4gICAgVG9Eb3MuYXBwTW9kdWxlID0gYW5ndWxhci5tb2R1bGUoXCJ0b2Rvc1wiLCBkZXBzKTtcbiAgICBUb0Rvcy5hcHBNb2R1bGUuY29uZmlnKGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoe1xuICAgICAgICAgICAgbmFtZTogXCJyb290XCIsXG4gICAgICAgICAgICB1cmw6IFwiL1wiLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwicm9vdC9yb290Lmh0bWxcIixcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFwiUm9vdENvbnRyb2xsZXJcIixcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogXCJyb290Q3RybFwiXG4gICAgICAgIH0pO1xuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKFwiL1wiKTtcbiAgICB9KTtcbn0pKFRvRG9zIHx8IChUb0RvcyA9IHt9KSk7XG5cbnZhciBUb0RvcztcbihmdW5jdGlvbiAoVG9Eb3MpIHtcbiAgICBUb0Rvcy5maWx0ZXJNb2R1bGUgPSBhbmd1bGFyLm1vZHVsZShcInRvZG9zLmZpbHRlcnNcIiwgW10pO1xufSkoVG9Eb3MgfHwgKFRvRG9zID0ge30pKTtcblxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIm1vZHVsZS50c1wiIC8+XG52YXIgVG9Eb3M7XG4oZnVuY3Rpb24gKFRvRG9zKSB7XG4gICAgZnVuY3Rpb24gbW9tZW50RmlsdGVyKHZhbCwgZm9ybWF0KSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsICE9PSBcInN0cmluZ1wiKVxuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgdmFyIG0gPSBtb21lbnQodmFsKTtcbiAgICAgICAgaWYgKCFtLmlzVmFsaWQoKSlcbiAgICAgICAgICAgIHJldHVybiB2YWw7XG4gICAgICAgIHJldHVybiBtLmZvcm1hdChmb3JtYXQgfHwgXCJERCBNTSBZWVlZXCIpO1xuICAgIH1cbiAgICBUb0Rvcy5maWx0ZXJNb2R1bGUuZmlsdGVyKFwibW9tZW50XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIG1vbWVudEZpbHRlcjsgfSk7XG59KShUb0RvcyB8fCAoVG9Eb3MgPSB7fSkpO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgY2hyaXNoYSBvbiAwMy8wOS8xNS5cbiAqL1xudmFyIFRvRG9zO1xuKGZ1bmN0aW9uIChUb0Rvcykge1xuICAgIFRvRG9zLnJvb3RNb2R1bGUgPSBhbmd1bGFyLm1vZHVsZShcInRvZG9zLnJvb3RcIiwgW10pO1xufSkoVG9Eb3MgfHwgKFRvRG9zID0ge30pKTtcblxuLyoqXG4gKiBDcmVhdGVkIGJ5IGNocmlzaGEgb24gMDMvMDkvMTUuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJtb2R1bGUudHNcIiAvPlxudmFyIFRvRG9zO1xuKGZ1bmN0aW9uIChUb0Rvcykge1xuICAgIHZhciBSb290Q29udHJvbGxlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFJvb3RDb250cm9sbGVyKCRzdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy4kc3RhdGUgPSAkc3RhdGU7XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VzID0gW1xuICAgICAgICAgICAgICAgIFwiV2VsY29tZVwiLFxuICAgICAgICAgICAgICAgIFwiTmV3IHZlcnNpb24gaXMgb3V0XCJcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICB0aGlzLnNob3dNZXNzYWdlcyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgUm9vdENvbnRyb2xsZXIucHJvdG90eXBlLnRvZ2dsZU1lc3NhZ2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5zaG93TWVzc2FnZXMgPSAhdGhpcy5zaG93TWVzc2FnZXM7XG4gICAgICAgIH07XG4gICAgICAgIFJvb3RDb250cm9sbGVyLnByb3RvdHlwZS5zdGF0ZUlzID0gZnVuY3Rpb24gKHN0YXRlTmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHN0YXRlLmlzKHN0YXRlTmFtZSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBSb290Q29udHJvbGxlcjtcbiAgICB9KSgpO1xuICAgIFRvRG9zLnJvb3RNb2R1bGUuY29udHJvbGxlcihcIlJvb3RDb250cm9sbGVyXCIsIFJvb3RDb250cm9sbGVyKTtcbn0pKFRvRG9zIHx8IChUb0RvcyA9IHt9KSk7XG5cbnZhciBUb0RvcztcbihmdW5jdGlvbiAoVG9Eb3MpIHtcbiAgICB2YXIgZGVwcyA9IFtcbiAgICAgICAgXCJuZ01lc3NhZ2VzXCIsXG4gICAgICAgIFwidWkucm91dGVyXCIsXG4gICAgICAgIFwidWkuYm9vdHN0cmFwXCIsXG4gICAgICAgIFwidG9kb3MuZmlsdGVyc1wiXG4gICAgXTtcbiAgICBUb0Rvcy50b2Rvc01vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKFwidG9kb3MubWFpblwiLCBkZXBzKTtcbiAgICBUb0Rvcy50b2Rvc01vZHVsZS5jb25maWcoZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoe1xuICAgICAgICAgICAgbmFtZTogXCJyb290LnRvZG9zXCIsXG4gICAgICAgICAgICB1cmw6IFwidG9kb3NcIixcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBcIi90b2Rvcy9saXN0Lmh0bWxcIixcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFwiTGlzdENvbnRyb2xsZXJcIixcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogXCJsaXN0Q3RybFwiXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoe1xuICAgICAgICAgICAgbmFtZTogXCJyb290LnRvZG9zLml0ZW1cIixcbiAgICAgICAgICAgIHVybDogXCIvOmlkXCIsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogXCIvdG9kb3MvaXRlbS5odG1sXCIsXG4gICAgICAgICAgICBjb250cm9sbGVyOiBcIkl0ZW1Db250cm9sbGVyXCIsXG4gICAgICAgICAgICBjb250cm9sbGVyQXM6IFwiaXRlbUN0cmxcIlxuICAgICAgICB9KTtcbiAgICB9KTtcbn0pKFRvRG9zIHx8IChUb0RvcyA9IHt9KSk7XG5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJtb2R1bGUudHNcIiAvPlxudmFyIFRvRG9zO1xuKGZ1bmN0aW9uIChUb0Rvcykge1xuICAgIHZhciBBZGROZXdDb250cm9sbGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gQWRkTmV3Q29udHJvbGxlcih0b2RvU2VydmljZSwgJG1vZGFsSW5zdGFuY2UpIHtcbiAgICAgICAgICAgIHRoaXMudG9kb1NlcnZpY2UgPSB0b2RvU2VydmljZTtcbiAgICAgICAgICAgIHRoaXMuJG1vZGFsSW5zdGFuY2UgPSAkbW9kYWxJbnN0YW5jZTtcbiAgICAgICAgfVxuICAgICAgICBBZGROZXdDb250cm9sbGVyLnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHZhciB0b2RvID0ge1xuICAgICAgICAgICAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgdGV4dDogdGhpcy50ZXh0LFxuICAgICAgICAgICAgICAgIGNyZWF0ZWQ6IG1vbWVudCgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnRvZG9TZXJ2aWNlLmFkZCh0b2RvKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy4kbW9kYWxJbnN0YW5jZS5jbG9zZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBBZGROZXdDb250cm9sbGVyO1xuICAgIH0pKCk7XG4gICAgVG9Eb3MudG9kb3NNb2R1bGUuY29udHJvbGxlcihcIkFkZE5ld0NvbnRyb2xsZXJcIiwgQWRkTmV3Q29udHJvbGxlcik7XG59KShUb0RvcyB8fCAoVG9Eb3MgPSB7fSkpO1xuXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwibW9kdWxlLnRzXCIgLz5cbnZhciBUb0RvcztcbihmdW5jdGlvbiAoVG9Eb3MpIHtcbiAgICB2YXIgTGlzdENvbnRyb2xsZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBMaXN0Q29udHJvbGxlcih0b2RvU2VydmljZSwgJHdpbmRvdywgJG1vZGFsKSB7XG4gICAgICAgICAgICB0aGlzLnRvZG9TZXJ2aWNlID0gdG9kb1NlcnZpY2U7XG4gICAgICAgICAgICB0aGlzLiR3aW5kb3cgPSAkd2luZG93O1xuICAgICAgICAgICAgdGhpcy4kbW9kYWwgPSAkbW9kYWw7XG4gICAgICAgICAgICB0aGlzLmxvYWQoKTtcbiAgICAgICAgfVxuICAgICAgICBMaXN0Q29udHJvbGxlci5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLnRvZG9TZXJ2aWNlLmxpc3QoKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh0b2Rvcykge1xuICAgICAgICAgICAgICAgIF90aGlzLnRvZG9zID0gdG9kb3M7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy4kd2luZG93LmNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBMaXN0Q29udHJvbGxlci5wcm90b3R5cGUuYWRkTmV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuJG1vZGFsLm9wZW4oe1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFwiQWRkTmV3Q29udHJvbGxlclwiLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogXCJhZGROZXdDdHJsXCIsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwiL3RvZG9zL2FkZG5ldy5odG1sXCIsXG4gICAgICAgICAgICAgICAgYmFja2Ryb3A6IFwic3RhdGljXCIgLy8gcHJldmVudHMgY2xpY2thd2F5IGZyb20gY2xvc2luZ1xuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmxvYWQoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gTGlzdENvbnRyb2xsZXI7XG4gICAgfSkoKTtcbiAgICBUb0Rvcy50b2Rvc01vZHVsZS5jb250cm9sbGVyKFwiTGlzdENvbnRyb2xsZXJcIiwgTGlzdENvbnRyb2xsZXIpO1xufSkoVG9Eb3MgfHwgKFRvRG9zID0ge30pKTtcblxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIm1vZHVsZS50c1wiIC8+XG52YXIgVG9Eb3M7XG4oZnVuY3Rpb24gKFRvRG9zKSB7XG4gICAgdmFyIFRvRG9TZXJ2aWNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gVG9Eb1NlcnZpY2UoJGh0dHApIHtcbiAgICAgICAgICAgIHRoaXMuJGh0dHAgPSAkaHR0cDtcbiAgICAgICAgfVxuICAgICAgICBUb0RvU2VydmljZS5wcm90b3R5cGUubGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLmdldChcIi9hcGkvdG9kb3NcIiwgeyBjYWNoZTogZmFsc2UgfSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBUb0RvU2VydmljZS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKHRvZG8pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnBvc3QoXCIvYXBpL3RvZG9zXCIsIHRvZG8pXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7IHJldHVybiByZXNwb25zZS5kYXRhOyB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgVG9Eb1NlcnZpY2UucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAuZ2V0KFwiL2FwaS90b2Rvcy9cIiArIGlkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgeyByZXR1cm4gcmVzcG9uc2UuZGF0YTsgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBUb0RvU2VydmljZTtcbiAgICB9KSgpO1xuICAgIFRvRG9zLlRvRG9TZXJ2aWNlID0gVG9Eb1NlcnZpY2U7XG4gICAgVG9Eb3MudG9kb3NNb2R1bGUuc2VydmljZShcInRvZG9TZXJ2aWNlXCIsIFRvRG9TZXJ2aWNlKTtcbn0pKFRvRG9zIHx8IChUb0RvcyA9IHt9KSk7XG5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJtb2R1bGUudHNcIiAvPlxudmFyIFRvRG9zO1xuKGZ1bmN0aW9uIChUb0Rvcykge1xuICAgIHZhciBJdGVtQ29udHJvbGxlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIEl0ZW1Db250cm9sbGVyKCRzdGF0ZVBhcmFtcywgdG9kb1NlcnZpY2UpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0b2RvU2VydmljZS5nZXQoJHN0YXRlUGFyYW1zLmlkKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh0b2RvKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMudG9kbyA9IHRvZG87XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gSXRlbUNvbnRyb2xsZXI7XG4gICAgfSkoKTtcbiAgICBUb0Rvcy50b2Rvc01vZHVsZS5jb250cm9sbGVyKFwiSXRlbUNvbnRyb2xsZXJcIiwgSXRlbUNvbnRyb2xsZXIpO1xufSkoVG9Eb3MgfHwgKFRvRG9zID0ge30pKTtcbiIsIlxubmFtZXNwYWNlIFRvRG9zIHtcblxuICAgIHZhciBkZXBzID0gW1xuICAgICAgICBcIm5nTWVzc2FnZXNcIixcbiAgICAgICAgXCJ1aS5yb3V0ZXJcIixcbiAgICAgICAgXCJ1aS5ib290c3RyYXBcIixcbiAgICAgICAgXCJ0b2Rvcy5maWx0ZXJzXCJcbiAgICBdXG5cbiAgICBleHBvcnQgdmFyIHRvZG9zTW9kdWxlID0gYW5ndWxhci5tb2R1bGUoXCJ0b2Rvcy5tYWluXCIsIGRlcHMpO1xuXG4gICAgdG9kb3NNb2R1bGUuY29uZmlnKCgkc3RhdGVQcm92aWRlcjogYW5ndWxhci51aS5JU3RhdGVQcm92aWRlcikgPT4ge1xuXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoe1xuICAgICAgICAgICAgICAgIG5hbWU6IFwicm9vdC50b2Rvc1wiLFxuICAgICAgICAgICAgICAgIHVybDogXCJ0b2Rvc1wiLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBcIi90b2Rvcy9saXN0Lmh0bWxcIixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBcIkxpc3RDb250cm9sbGVyXCIsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiBcImxpc3RDdHJsXCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoe1xuICAgICAgICAgICAgICAgIG5hbWU6IFwicm9vdC50b2Rvcy5pdGVtXCIsXG4gICAgICAgICAgICAgICAgdXJsOiBcIi86aWRcIixcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogXCIvdG9kb3MvaXRlbS5odG1sXCIsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogXCJJdGVtQ29udHJvbGxlclwiLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogXCJpdGVtQ3RybFwiXG4gICAgICAgICAgICB9KTtcbiAgICB9KVxuXG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwibW9kdWxlLnRzXCIgLz5cbm5hbWVzcGFjZSBUb0RvcyB7XG4gICAgY2xhc3MgQWRkTmV3Q29udHJvbGxlciB7XG4gICAgICAgIHB1YmxpYyB0ZXh0OiBzdHJpbmc7XG4gICAgICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgdG9kb1NlcnZpY2U6IFRvRG9TZXJ2aWNlLFxuICAgICAgICAgICAgICAgICAgICBwcml2YXRlICRtb2RhbEluc3RhbmNlOiBhbmd1bGFyLnVpLmJvb3RzdHJhcC5JTW9kYWxTZXJ2aWNlSW5zdGFuY2UpIHtcbiAgICAgICAgfVxuICAgICAgICBwdWJsaWMgc2F2ZSgpIHtcbiAgICAgICAgICAgIHZhciB0b2RvID0ge1xuICAgICAgICAgICAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgdGV4dDogdGhpcy50ZXh0LFxuICAgICAgICAgICAgICAgIGNyZWF0ZWQ6IG1vbWVudCgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnRvZG9TZXJ2aWNlLmFkZCh0b2RvKVxuICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kbW9kYWxJbnN0YW5jZS5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvZG9zTW9kdWxlLmNvbnRyb2xsZXIoXCJBZGROZXdDb250cm9sbGVyXCIsIEFkZE5ld0NvbnRyb2xsZXIpO1xufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIm1vZHVsZS50c1wiIC8+XG5cbm5hbWVzcGFjZSBUb0RvcyB7XG5cbiAgICBpbnRlcmZhY2UgVG9EbyB7XG4gICAgICAgIGlkOiBzdHJpbmc7XG4gICAgICAgIHRleHQ6IHN0cmluZztcbiAgICAgICAgdGFnczogc3RyaW5nW107IC8vIGFjdHVhbGwgZGF0ZXNcbiAgICAgICAgZHVlOiBzdHJpbmc7IC8vIGFjdHVhbGwgZGF0ZVxuICAgICAgICBkb25lOiBzdHJpbmc7IC8vIGFjdHVhbGwgZGF0ZVxuXG4gICAgfVxuXG4gICAgY2xhc3MgTGlzdENvbnRyb2xsZXIge1xuICAgICAgICBwdWJsaWMgdG9kb3M6VG9Eb1tdO1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgdG9kb1NlcnZpY2U6VG9Eb1NlcnZpY2UsXG4gICAgICAgICAgICAgICAgICAgIHByaXZhdGUgJHdpbmRvdzphbmd1bGFyLklXaW5kb3dTZXJ2aWNlLFxuICAgICAgICAgICAgICAgICAgICBwcml2YXRlICRtb2RhbDpNb2RhbFNlcnZpY2UpIHtcbiAgICAgICAgICAgIHRoaXMubG9hZCgpO1xuICAgICAgICB9XG5cblxuICAgICAgICBwcml2YXRlXG4gICAgICAgICAgICBsb2FkKClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZG9TZXJ2aWNlLmxpc3QoKVxuICAgICAgICAgICAgICAgICAgICAudGhlbigodG9kb3MpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9kb3MgPSB0b2RvcztcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kd2luZG93LmNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIHB1YmxpYyBhZGROZXcoKSB7XG4gICAgICAgICAgICB0aGlzLiRtb2RhbC5vcGVuKHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBcIkFkZE5ld0NvbnRyb2xsZXJcIixcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6IFwiYWRkTmV3Q3RybFwiLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBcIi90b2Rvcy9hZGRuZXcuaHRtbFwiLFxuICAgICAgICAgICAgICAgIGJhY2tkcm9wOiBcInN0YXRpY1wiIC8vIHByZXZlbnRzIGNsaWNrYXdheSBmcm9tIGNsb3NpbmdcbiAgICAgICAgICAgIH0pLnJlc3VsdC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkKCk7XG5cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdG9kb3NNb2R1bGUuY29udHJvbGxlcihcIkxpc3RDb250cm9sbGVyXCIsIExpc3RDb250cm9sbGVyKTtcblxuXG5cbn0iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwibW9kdWxlLnRzXCIgLz5cbm5hbWVzcGFjZSBUb0RvcyB7XG4gICAgZXhwb3J0IGNsYXNzIFRvRG9TZXJ2aWNlIHtcbiAgICAgICAgY29uc3RydWN0b3IocHJpdmF0ZSAkaHR0cDogYW5ndWxhci5JSHR0cFNlcnZpY2UpIHtcbiAgICAgICAgfVxuICAgICAgICBwdWJsaWMgbGlzdCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLmdldDxUb0RvW10+KFwiL2FwaS90b2Rvc1wiLCB7Y2FjaGU6IGZhbHNlfSlcbiAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcHVibGljIGFkZCh0b2RvOiBUb0RvKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cC5wb3N0KFwiL2FwaS90b2Rvc1wiLCB0b2RvKVxuICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gcmVzcG9uc2UuZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgcHVibGljIGdldChpZDpzdHJpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLmdldDxUb0RvPihcIi9hcGkvdG9kb3MvXCIgKyBpZClcbiAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvZG9zTW9kdWxlLnNlcnZpY2UoXCJ0b2RvU2VydmljZVwiLCBUb0RvU2VydmljZSk7XG59XG5cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJtb2R1bGUudHNcIiAvPlxubmFtZXNwYWNlIFRvRG9zIHtcbiAgICBpbnRlcmZhY2UgSXRlbVN0YXRlUGFyYW1zIHtcbiAgICAgICAgaWQ6IHN0cmluZztcbiAgICB9XG4gICAgY2xhc3MgSXRlbUNvbnRyb2xsZXIge1xuICAgICAgICBwdWJsaWMgdG9kbzogVG9EbztcbiAgICAgICAgY29uc3RydWN0b3IoJHN0YXRlUGFyYW1zOiBJdGVtU3RhdGVQYXJhbXMsXG4gICAgICAgICAgICAgICAgICAgIHRvZG9TZXJ2aWNlOiBUb0RvU2VydmljZSkge1xuICAgICAgICAgICAgdG9kb1NlcnZpY2UuZ2V0KCRzdGF0ZVBhcmFtcy5pZClcbiAgICAgICAgICAgICAgICAudGhlbigodG9kbykgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZG8gPSB0b2RvO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRvZG9zTW9kdWxlLmNvbnRyb2xsZXIoXCJJdGVtQ29udHJvbGxlclwiLCBJdGVtQ29udHJvbGxlcik7XG59XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=